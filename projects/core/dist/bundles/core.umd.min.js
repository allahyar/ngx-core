!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("@angular/common/http"),require("@ngx-translate/core"),require("@ngx-translate/http-loader"),require("@angular/common"),require("@angular/router")):"function"==typeof define&&define.amd?define("core",["exports","@angular/core","rxjs","@angular/common/http","@ngx-translate/core","@ngx-translate/http-loader","@angular/common","@angular/router"],t):t((e=e||self).core={},e.ng.core,e.rxjs,e.ng.common.http,e.core$1,e.httpLoader,e.ng.common,e.ng.router)}(this,function(e,t,r,n,o,i,c,a){"use strict";var u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function s(e,t){function r(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function p(e,t,r,n){var o,i=arguments.length,c=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(c=(i<3?o(c):i>3?o(t,r,c):o(t,r))||c);return i>3&&c&&Object.defineProperty(t,r,c),c}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var f={prefix:"ZarsamErp"},d=new t.InjectionToken("QueryService"),g=new t.InjectionToken("DefaultLang"),y=new t.InjectionToken("SupportLang"),h=function(){};function v(e,r,n){return void 0===r&&(r=null),function(o,i){var c=Object.getOwnPropertyDescriptor(o,i);Object.defineProperty(o,i,{get:function(){if(this["$$$Inject_"+e.toString()])return this["$$$Inject_"+e.toString()];var i=this.injector||this.$$$_Injector;if(!i)for(var c in this)this.hasOwnProperty(c)&&(this[c]instanceof t.Injector||this[c]&&"Injector_"===this[c].constructor.name)&&(i=this[c],this.$$$_Injector=i);i?"StaticInjector"===i.constructor.name&&i.parent&&(i=i.parent):console.warn("Could not find local Injector in  ("+o.constructor.name+"), use root injector instead!");var a=(i||window.$$$_root_injector).get(e,r,n);return this["$$$"+e.toString()]=a,a},enumerable:null==c||c.enumerable,configurable:null==c||c.configurable})}}var j=function(){function e(e,t){this.http=e,this.injector=t}return e.prototype.get=function(e){return new r.Observable(function(e){e.next({success:!0}),e.complete()})},e.prototype.post=function(e,t,r){return this.http.post(e,t,r)},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:n.HttpClient},{type:t.Injector}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(n.HttpClient),t.ɵɵinject(t.INJECTOR))},token:e,providedIn:"root"}),e}(),b=function(e){function r(t){var r=e.call(this)||this;return r.injector=t,r}return s(r,e),r.prototype.delete=function(e){return this.http.get("dadad")},r.prototype.get=function(e){},r.prototype.list=function(e){},r.prototype.post=function(e){},r.prototype.grid=function(e){},r.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],r.ctorParameters=function(){return[{type:t.Injector}]},r.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new r(t.ɵɵinject(t.INJECTOR))},token:r,providedIn:"root"}),p([v(j),l("design:type",j)],r.prototype,"http",void 0),r}(h);function I(e){return new i.TranslateHttpLoader(e,"./assets/i18n/",".json")}var _=I,m={loader:{provide:o.TranslateLoader,useFactory:_,deps:[n.HttpClient]}},S=function(){function e(){}return e.prototype.setDirection=function(e){this.document.dir=e},Object.defineProperty(e.prototype,"direction",{get:function(){return this.document.dir},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[]},p([v(c.DOCUMENT),l("design:type",Document)],e.prototype,"document",void 0),e}(),w=function(){function e(e,t,r){var n=this;window.$$$_root_injector=r,this._translateService.addLangs(t),this._translateService.setDefaultLang(e),this._translateService.use(e).subscribe(function(t){var r="fa"===e?"rtl":"ltr";n._uiService.setDirection(r)})}return e.forRoot=function(t){return{ngModule:e,providers:[S,{provide:"config",useValue:t},{provide:h,useClass:b},{provide:d,useValue:b},{provide:g,useValue:t&&t.language.default||"en"},{provide:y,useValue:t&&t.language.support||["en","fa"]}]}},e.decorators=[{type:t.NgModule,args:[{declarations:[],imports:[n.HttpClientModule,o.TranslateModule.forRoot(m)],exports:[o.TranslateModule]}]}],e.ctorParameters=function(){return[{type:String,decorators:[{type:t.Inject,args:[g]}]},{type:Array,decorators:[{type:t.Inject,args:[y]}]},{type:t.Injector}]},p([v(o.TranslateService),l("design:type",o.TranslateService)],e.prototype,"_translateService",void 0),p([v(S),l("design:type",S)],e.prototype,"_uiService",void 0),e}(),O=function(e){function t(t){var r=e.call(this,t)||this;return r.name="TokenError",r}return s(t,e),t}(Error),k=function(){function e(e){this.token=e,null!=this.token&&this.isExpired()&&(e=null)}return e.prototype.decodeBase64=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new O("Illegal base64url string!")}return decodeURIComponent(escape("undefined"==typeof window?atob(t):window.atob(t)))},e.prototype.decodeToken=function(){var e=this.token.split(".");if(3!==e.length)throw new O("A JWT Token must have 3 parts!");var t=this.decodeBase64(e[1]);if(!t)throw new O("Cannot decode the token!");return JSON.parse(t)},e.prototype.getExpirationDate=function(){var e=this.decodeToken();if(!e.hasOwnProperty("exp"))return new Date;var t=new Date(0);return t.setUTCSeconds(e.exp),t},e.prototype.isExpired=function(e){void 0===e&&(e=0);var t=this.getExpirationDate();return t.getSeconds()!==(new Date).getSeconds()&&!(t.valueOf()>(new Date).valueOf()+1e3*e)},e}(),T=function(){function e(){this._token=new r.BehaviorSubject(new k(localStorage.getItem("satellizer_token")))}return e.prototype.getToken=function(){var e=this._token.getValue();return e&&e.token?e:null},e.prototype.getTokenStream=function(){return this._token.asObservable()},e.prototype.setToken=function(e){this._token.next(new k(e))},e.prototype.removeToken=function(){this._token.next(null)},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),x=function(){function e(e){this.config=e,this._currentUserValue=new r.ReplaySubject}return Object.defineProperty(e.prototype,"currentUserValue",{get:function(){return this._currentUserValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentUser",{get:function(){return this._currentUserValue.asObservable()},enumerable:!0,configurable:!0}),e.prototype.verifyToken=function(e){var t=this;return new Promise(function(r,n){t.http.get(t.config.loginEndPoint+e).subscribe(function(e){if(e.success)return r(e),!0},function(e){return n(e)})})},e.prototype.loggedIn=function(){return null!==this.currentUser},e.prototype.logout=function(){return this._currentUserValue.next(null),this._currentUserValue.asObservable()},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Inject,args:["config"]}]}]},p([v(j),l("design:type",j)],e.prototype,"http",void 0),e}(),$=function(){function e(e){this.config=e}return e.prototype.canActivate=function(){var e=this._tokenService.getToken();if(e&&e.token)return!e.isExpired();var t=this.config.guards.loggedInGuard.redirectUrl;return!!t&&this._router.navigate([t])},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Inject,args:["config"]}]}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject("config"))},token:e,providedIn:"root"}),p([v(x),l("design:type",x)],e.prototype,"_authenticationService",void 0),p([v(T),l("design:type",T)],e.prototype,"_tokenService",void 0),p([v(a.Router),l("design:type",a.Router)],e.prototype,"_router",void 0),e}(),P=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[{provide:"config",useValue:t},x,$]}},e.decorators=[{type:t.NgModule,args:[{declarations:[],imports:[c.CommonModule,n.HttpClientModule,a.RouterModule]}]}],e}(),D=function(){function e(e){e&&(this._prefix=e.prefix||f.prefix)}return e.prototype.set=function(e,t,r,n){if(null!==t){var o={expire:r||0,data:t};localStorage.setItem((n||this._prefix)+"."+e,JSON.stringify(o))}},e.prototype.getKey=function(e){e<0&&console.error(new Error("index has to be 0 or greater"));try{return localStorage.key(e)}catch(e){console.error(e)}},e.prototype.has=function(e,t){return(t||this._prefix)+"."+e in localStorage},e.prototype.get=function(e,t){try{return localStorage.getItem((t||this._prefix)+"."+e)}catch(e){console.error(e)}},e.prototype.remove=function(e,t){try{localStorage.removeItem((t||this._prefix)+"_"+e)}catch(e){console.error(e)}},e.prototype.clear=function(){try{localStorage.clear()}catch(e){console.error(e)}},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Inject,args:["config"]}]}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject("config"))},token:e,providedIn:"root"}),e}();e.AUTH_CONFIG_DEFAULTS={loginEndPoint:"/login"},e.AuthModule=P,e.AuthenticationService=x,e.CoreModule=w,e.DEFAULT_LANG=g,e.GlobalInject=function(e,t,r){return void 0===t&&(t=null),function(n,o){var i=Object.getOwnPropertyDescriptor(n,o);Object.defineProperty(n,o,{get:function(){if(this["$$$Inject_"+e.toString()])return this["$$$Inject_"+e.toString()];var o=this.injectors;if(o)for(var i=o.length-1;i>=0;--i){var c=o[i].get(e,t,r);return this["$$$"+e.toString()]=c,c}else console.warn("Could not find local Injectors in  ("+n.constructor.name+")!")},enumerable:null==i||i.enumerable,configurable:null==i||i.configurable})}},e.HttpLoaderFactory=I,e.HttpProvider=j,e.InjectToken=v,e.LOCAL_STORAGE_CONFIG_DEFAULTS=f,e.LocalStorage=D,e.LoggedInAuth=$,e.MODULE_CONFIG_DEFAULTS={},e.QUERY_SERVICE_TOKEN=d,e.Query=h,e.QueryService=b,e.SUPPORT_LANG=y,e.UiService=S,e.translateModuleOptions=m,e.ɵc=T,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=core.umd.min.js.map